<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/102/three.min.js"></script>
    <script src="https://unpkg.com/three@0.85.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/mrdoob/three.js@r92/examples/js/loaders/GLTFLoader.js"></script>

    <title>Parcial Final</title>
  </head>
  <body>
    <script>
      //globals
      var scene;
      var camera;
      var renderer;
      var controls;

      // font settings
      var fontName = "helvetiker"; // helvetiker, optimer, gentilis, droid sans, droid serif
      var fontWeight = "regular";

      /*BEGINNING OF PAGE CONFIG*/
      function init() {
        //create scene
        scene = new THREE.Scene();
        //create camera
        createCamera();
        //create renderer
        renderer = new THREE.WebGLRenderer({
          antialias: true,
        });
        //set renderer size
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        const Tloader = THREE.TextureLoader();
        const bgTexture = new THREE.TextureLoader().load("./res/bg.jpg");

        scene.background = bgTexture;
        //scene.background = new THREE.Color(0xFFFFFF);
        controls = new THREE.OrbitControls(camera, renderer.domElement);
      }

      function createCamera() {
        camera = new THREE.PerspectiveCamera(
          90, //fov
          window.innerWidth / window.innerHeight, //aspect
          0.1, //near
          2000 //far
        );

        camera.position.set(0, 0, 60);

        camera.translateZ(50);
      }

      function renderLoop() {
        requestAnimationFrame(renderLoop);
        renderer.render(scene, camera);
        controls.update();
      }
      /*END OF PAGE CONFIG*/

      function createLightPoint(x, y, z) {
        var lightPoint = new THREE.DirectionalLight(0x404040, 10);
        lightPoint.name = "DirectionalLight";
        lightPoint.position.set(x, y, z);
        scene.add(lightPoint);
      }

      function skullBot() {
        var loader = new THREE.GLTFLoader();
        loader.load("./res/skullbot.glb", function (geometry) {
          mesh = geometry.scene;
          mesh.children.material = new THREE.MeshBasicMaterial();
          mesh.scale.set(30, 30, 30);
          scene.add(mesh);
        });
      }

      function listener() {
        console.log(true);
      }

      function skullTop() {
        var loader = new THREE.GLTFLoader();
        var eventer = new THREE.EventDispatcher();
        loader.load("./res/skulltop.glb", function (geometry) {
          mesh = geometry.scene;
          mesh.children.material = new THREE.MeshBasicMaterial();
          mesh.scale.set(30, 30, 30);
          mesh.addEventListener = eventer.addEventListener(
            "click",
            onclick,
            listener()
          );
          scene.add(mesh);
        });
      }

      function loadText(text) {
        const loader = new THREE.FontLoader();
        try {
          loader.load(
            "res/" + fontName + "_" + fontWeight + ".typeface.json",
            function (font) {
              const geometry = new THREE.TextGeometry(text, {
                font: font,
                size: 20,
                height: 1,
                curveSegments: 6,
                bevelEnabled: true,
                bevelThickness: 1,
                bevelSize: 0,
                bevelOffset: 0,
                bevelSegments: 0,
              });
              const material = new THREE.MeshBasicMaterial({ color: 0xffffff });
              let mesh = new THREE.Mesh(geometry, material);
              scene.add(mesh);
              mesh.position.set(-105, -70, 0);
              console.log(mesh.position);
            }
          );
        } catch (e) {
          console.error(e.message);
        }
      }

      init();
      skullBot();
      skullTop();
      createLightPoint(0, 30, 0);
      createLightPoint(0, -30, 0);
      loadText("Dientes Humanos");
      renderLoop();
    </script>
  </body>
</html>
